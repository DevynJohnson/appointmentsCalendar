# Zone Meet - Production Environment Variables Guide

## üîß Required Environment Variables for Render Deployment

### Core Application Settings
```bash
# Node.js Environment
NODE_ENV=production
PORT=3000
```

### Database Configuration
```bash
# PostgreSQL Database (Auto-generated by Render PostgreSQL service)
DATABASE_URL=postgresql://username:password@host:port/database
```

### Authentication & Security
```bash
# JWT Authentication (Custom implementation)
JWT_SECRET=your-super-secure-jwt-secret-minimum-32-characters-long

# Note: CSRF tokens are auto-generated with 256-bit entropy - no secret needed
```

### Email Service (Maileroo)
```bash
# Maileroo SMTP Configuration
MAILEROO_API_KEY=your-maileroo-api-key
MAILEROO_SMTP_USERNAME=your-smtp-username  
MAILEROO_SMTP_PASSWORD=your-smtp-password
MAILEROO_SMTP_HOST=smtp.maileroo.com
MAILEROO_SMTP_PORT=587
```

### üõ°Ô∏è WAF (Web Application Firewall) Settings
```bash
# WAF Core Configuration
WAF_ENABLED=true
WAF_BLOCK_SUSPICIOUS_PATTERNS=true

# Rate Limiting Configuration
WAF_RATE_LIMIT_WINDOW=60000
WAF_RATE_LIMIT_MAX_REQUESTS=100

# IP Access Control (Optional - comma-separated IPs)
WAF_IP_WHITELIST=
WAF_IP_BLACKLIST=

# Example with IPs:
# WAF_IP_WHITELIST=192.168.1.100,10.0.0.50
# WAF_IP_BLACKLIST=192.168.1.200,suspicious.ip.address
```

### üìä Security Monitoring (Sentry)
```bash
# Sentry Configuration (Optional but recommended)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=1.0.0

# Public Sentry (for client-side errors)
NEXT_PUBLIC_SENTRY_DSN=https://your-public-sentry-dsn@sentry.io/project-id
```

### üîê Calendar Integration APIs
```bash
# Google Calendar API
GOOGLE_CLIENT_ID=your-google-oauth-client-id
GOOGLE_CLIENT_SECRET=your-google-oauth-client-secret

# Microsoft Graph API (Outlook/Teams)
MICROSOFT_CLIENT_ID=your-microsoft-app-id
MICROSOFT_CLIENT_SECRET=your-microsoft-app-secret

# Apple Calendar (if implementing)
APPLE_CLIENT_ID=your-apple-client-id
APPLE_CLIENT_SECRET=your-apple-client-secret
```

### üìà Analytics (Optional)
```bash
# Google Analytics
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX

# PostHog Analytics (Alternative)
NEXT_PUBLIC_POSTHOG_KEY=your-posthog-project-api-key
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com
```

## üöÄ Render Dashboard Setup

### 1. Navigate to Environment Variables
1. Go to your Render service dashboard
2. Click on "Environment" tab
3. Add each variable using "Add Environment Variable"

### 2. Required Variables for Basic Operation
```bash
NODE_ENV=production
DATABASE_URL=[Auto-filled by Render PostgreSQL]
JWT_SECRET=your-jwt-secret-32-chars-min
MAILEROO_API_KEY=your-maileroo-api-key
MAILEROO_SMTP_USERNAME=your-smtp-username
MAILEROO_SMTP_PASSWORD=your-smtp-password
```

### 3. Security Variables (Recommended)
```bash
WAF_ENABLED=true
WAF_RATE_LIMIT_MAX_REQUESTS=100
WAF_BLOCK_SUSPICIOUS_PATTERNS=true
SENTRY_DSN=your-sentry-dsn
```

### 4. Calendar Integration (As Needed)
```bash
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
MICROSOFT_CLIENT_ID=your-microsoft-client-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
```

## üîë How to Generate Secure Secrets

### JWT Secret
```bash
# Generate a secure JWT secret (32+ characters)
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
```

## üéØ Environment-Specific Configurations

### Production (Render)
- `NODE_ENV=production`
- `WAF_ENABLED=true`
- `WAF_RATE_LIMIT_MAX_REQUESTS=100` (moderate for production)
- SSL enforced automatically by Render

### Staging (Optional)
- `NODE_ENV=staging`
- `WAF_ENABLED=true`
- `WAF_RATE_LIMIT_MAX_REQUESTS=200` (more lenient for testing)

### Development (Local)
- `NODE_ENV=development`
- `WAF_ENABLED=false` (or more lenient settings)
- `WAF_RATE_LIMIT_MAX_REQUESTS=1000`

## ‚ö†Ô∏è Security Notes

### üîí Critical Security Variables
**Never expose these in client-side code:**
- `JWT_SECRET`
- `DATABASE_URL`
- `MAILEROO_SMTP_PASSWORD`
- `GOOGLE_CLIENT_SECRET`
- `MICROSOFT_CLIENT_SECRET`

### üåç Public Variables (Safe for client-side)
**These can start with `NEXT_PUBLIC_`:**
- `NEXT_PUBLIC_GA_ID`
- `NEXT_PUBLIC_SENTRY_DSN`
- `NEXT_PUBLIC_POSTHOG_KEY`

### üõ°Ô∏è WAF Recommendations
- **Start conservative:** `WAF_RATE_LIMIT_MAX_REQUESTS=100`
- **Monitor logs** for false positives
- **Adjust gradually** based on legitimate traffic patterns
- **Keep WAF_ENABLED=true** in production always

## üìã Quick Setup Checklist

### ‚úÖ Essential Variables (Minimum for deployment)
- [ ] `NODE_ENV=production`
- [ ] `DATABASE_URL` (auto-filled by Render)
- [ ] `JWT_SECRET` (generate securely)
- [ ] `MAILEROO_API_KEY`
- [ ] `MAILEROO_SMTP_USERNAME`
- [ ] `MAILEROO_SMTP_PASSWORD`

### ‚úÖ Security Variables (Highly recommended)
- [ ] `WAF_ENABLED=true`
- [ ] `WAF_RATE_LIMIT_MAX_REQUESTS=100`
- [ ] `WAF_BLOCK_SUSPICIOUS_PATTERNS=true`
- [ ] `SENTRY_DSN` (for error tracking)

### ‚úÖ Feature Variables (As needed)
- [ ] Google Calendar integration variables
- [ ] Microsoft Calendar integration variables
- [ ] Analytics variables

## üö® Troubleshooting

### WAF Too Strict?
If legitimate users are being blocked:
1. Increase `WAF_RATE_LIMIT_MAX_REQUESTS` to 200
2. Check Render logs for WAF events
3. Temporarily set `WAF_BLOCK_SUSPICIOUS_PATTERNS=false`

### Authentication Issues?
1. Ensure `JWT_SECRET` is set and 32+ characters long
2. Check that JWT tokens are being sent in Authorization headers
3. Verify API endpoints are receiving valid Bearer tokens

### Email Not Working?
1. Verify all `MAILEROO_*` variables are set correctly
2. Test SMTP credentials with Maileroo dashboard
3. Check Render logs for email delivery errors

---

**Ready to Deploy? üöÄ**

Once you've added these environment variables to your Render service, your Zone Meet application will have enterprise-grade security and full functionality!